!function(e){var t={};function n(r){if(t[r])return t[r].exports;var c=t[r]={i:r,l:!1,exports:{}};return e[r].call(c.exports,c,c.exports,n),c.l=!0,c.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=13)}([function(e,t){!function(){e.exports=this.wp.element}()},function(e,t){!function(){e.exports=this.wp.i18n}()},function(e,t){!function(){e.exports=this.lodash}()},function(e,t){!function(){e.exports=this.wp.sanitize}()},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t){!function(){e.exports=this.wp.url}()},function(e,t,n){var r=n(4);e.exports=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},c=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(c=c.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),c.forEach(function(t){r(e,t,n[t])})}return e}},function(e,t){!function(){e.exports=this.wp.apiFetch}()},function(e,t,n){var r=n(14);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t,n){var r=n(16),c=n(15);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?c(e):t}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,n){"use strict";n.r(t);var r=n(0),c=n(6),o=n.n(c),s=n(4),a=n.n(s),i=n(12),u=n.n(i),l=n(11),p=n.n(l),f=n(10),m=n.n(f),d=n(9),b=n.n(d),w=n(8),O=n.n(w),j=n(1),h=n(7),y=n(5),g="https://2019.europe.wordcamp.org/wp-json/",v=!1;function E(e){return v?fetch("".concat(g).concat(e)).then(function(e){return e.json()}):Object(h.apiFetch)({path:e})}var x=n(2),_=n(3),k=function(e){var t=e.post,n=t.date_gmt,c=t.link,o=t.title.rendered,s=t.excerpt.rendered,a=t._embedded["wp:term"],i=t.categories,u=Object(x.keyBy)(Object(x.flatten)(a),"id");return Object(r.createElement)("div",{className:"wordcamp-latest-post"},Object(r.createElement)("h4",{className:"wordcamp-latest-post-title"},Object(r.createElement)("a",{href:c},Object(_.stripTagsAndEncodeText)(o))),Object(r.createElement)("span",{className:"wordcamp-latest-post-date"},new Date(n).toLocaleDateString()),Object(r.createElement)("span",{className:"wordcamp-latest-post-excerpt"},Object(_.stripTagsAndEncodeText)(s)),Object(r.createElement)("span",{className:"wordcamp-latest-post-categories"},i.length&&i.map(function(e,t){var n=u[e],c=n.name,o=n.link;return Object(r.createElement)("a",{key:t,href:o},c)})))},P=function(){return Object(r.createElement)("div",{className:"wordcamp-loading"},Object(j._x)("Loading...","pwa-placeholder","wordcamp-pwa-page"))},S=function(e){var t=e.list,n=t.isFetching,c=t.data;return n&&0===c.length?Object(r.createElement)(P,null):Object(r.createElement)(r.Fragment,null,c.filter(function(e){return!!e}).map(function(e){return Object(r.createElement)(k,{key:e.id,post:e})}))},L=function(e){var t,n,c=e.session,o=c.session,s=o.link,a=o.title.rendered,i=o.session_date_time.time,u=o.session_category,l=o._embedded,p=l["wp:term"],f=l.speakers,m=void 0===f?[]:f,d=o.meta._wcpt_session_type,b=void 0===d?"":d,w=c.track,O=w.name,j=w.slug,h=Object(x.keyBy)(Object(x.flatten)(p),"id"),y=m.filter(function(e){return!!e.id});if(u.length>0){var g=u[0];t=h[g].name,n=h[g].slug}return Object(r.createElement)("div",{className:"wordcamp-schedule-session ".concat(b)},Object(r.createElement)("span",{className:"wordcamp-schedule-session-track ".concat(j)},O),Object(r.createElement)("h4",{className:"wordcamp-schedule-session-title"},Object(r.createElement)("a",{href:s},Object(_.stripTagsAndEncodeText)(a))),Object(r.createElement)("span",{className:"wordcamp-schedule-session-time"},i),Object(r.createElement)("span",{className:"wordcamp-schedule-session-speaker"},!!y.length&&y.map(function(e){var t=e.id,n=e.title.rendered,c=e.link;return Object(r.createElement)("a",{key:t,href:c},Object(_.stripTagsAndEncodeText)(n))})),!!t&&Object(r.createElement)("span",{className:"wordcamp-schedule-session-category ".concat(n)},t))},N=function(e){var t=e.title,n=e.sessions;return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("h3",null,t),n.filter(function(e){return!!e}).map(function(e){return Object(r.createElement)(L,{key:"".concat(e.session.id,"-").concat(e.track.id),session:e})}))},F=function(e){var t=e.sessionList,n=e.trackList;if((t.isFetching||n.isFetching)&&0===t.data.length)return Object(r.createElement)(P,null);var c=function(e){var t=window.now||new Date;if(Array.isArray(e.tracks))return e.tracks.map(function(n){var r=Object(x.sortBy)(e.sessions.filter(function(e){return e.session_track.includes(n.id)}),function(e){return e.meta._wcpt_session_time}),c=r.findIndex(function(e){return t<new Date(1e3*e.meta._wcpt_session_time)}),o=r[c],s=r[c-1];return{track:n,now:s,next:o}})}({sessions:t.data,tracks:n.data}),o=c.map(function(e){return{track:e.track,session:e.now}}).filter(function(e){return!!e.session}),s=c.map(function(e){return{track:e.track,session:e.next}});return Object(r.createElement)(r.Fragment,null,o.length?Object(r.createElement)(N,{sessions:o,title:Object(j._x)("On now","title","wordcamp-pwa-page")}):"",s.length&&Object(r.createElement)(N,{sessions:s,title:Object(j._x)("Up next","title","wordcamp-pwa-page")}))},A={sessionList:function(){return E(Object(y.addQueryArgs)("wp/v2/sessions",{per_page:100,status:"publish",_embed:!0}))},trackList:function(){return E(Object(y.addQueryArgs)("wp/v2/session_track",{per_page:100,status:"publish"}))},postList:function(){return E(Object(y.addQueryArgs)("wp/v2/posts",{per_page:3,status:"publish",_embed:!0}))}},T=function(e){function t(e){var n;u()(this,t),(n=m()(this,b()(t).call(this,e))).updateInterval=-1,n.state={};for(var r=0,c=Object.keys(A);r<c.length;r++){var o=c[r];n.state[o]={isFetching:!0,error:null,data:[]}}return n}return O()(t,e),p()(t,[{key:"updateLists",value:function(){for(var e=this,t=function(){var t=r[n];A[t]().then(function(n){e.setState(a()({},t,{isFetching:!1,data:n}))}).catch(function(n){return e.setState(function(e){return o()({},e,a()({},t,o()({},e[t],{isFetching:!1,error:n})))})})},n=0,r=Object.keys(A);n<r.length;n++)t()}},{key:"componentDidMount",value:function(){this.updateLists(),this.updateInterval=window.setInterval(this.updateLists,6e4)}},{key:"componentWillUnmount",value:function(){window.clearInterval(this.updateInterval)}},{key:"render",value:function(){var e=this.state,t=e.postList,n=e.sessionList,c=e.trackList;return Object(r.createElement)(r.Fragment,null,Object(r.createElement)("div",{className:"pwa-page-content"},Object(r.createElement)(F,{sessionList:n,trackList:c}),Object(r.createElement)("a",{href:window.WCPWAP.urls.schedule,className:"full-schedule"},Object(j._x)("View Full Schedule","text","wordcamp-pwa-page"))),Object(r.createElement)("div",{className:"pwa-page-content"},Object(r.createElement)("h2",null,Object(j._x)("Latest Posts","title","wordcamp-pwa-page")),Object(r.createElement)(S,{list:t}),Object(r.createElement)("a",{href:window.WCPWAP.urls.posts,className:"all-posts"},Object(j._x)("View all Posts","title","wordcamp-pwa-page"))))}}]),t}(r.Component),D=document.getElementById("pwa-root");Object(r.render)(Object(r.createElement)(T,null),D),window.setDate=function(e){window.now=e}},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(t){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?e.exports=r=function(e){return n(e)}:e.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},r(t)}e.exports=r}]);